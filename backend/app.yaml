runtime: python39

# This sample incurs costs to run on the App Engine flexible environment.
# The settings below are to reduce costs during testing and are not appropriate
# for production use. For more information, see:
# https://cloud.google.com/appengine/docs/flexible/python/configuring-your-app-with-app-yaml
manual_scaling:
  instances: 1
resources:
  cpu: 1
  memory_gb: 0.5
  disk_size_gb: 10

# Environment variables
env_variables:
  DJANGO_SETTINGS_MODULE: "uml_diagrams_backend.settings_production"
  DEBUG: "False"
  # Database configuration
  DB_NAME: "your-database-name"
  DB_USER: "your-database-user"
  DB_PASSWORD: "your-database-password"
  DB_HOST: "/cloudsql/your-project-id:your-region:your-instance-name"
  DB_PORT: "5432"
  
  # Google Cloud Storage
  GS_BUCKET_NAME: "your-bucket-name"
  GS_PROJECT_ID: "your-project-id"
  USE_GCS: "True"
  
  # Redis (using Google Cloud Memorystore)
  REDIS_URL: "redis://10.0.0.3:6379"
  
  # CORS allowed origins (add your domain)
  CORS_ALLOWED_ORIGINS: "https://your-domain.com,https://your-app-engine-url.appspot.com"
  
  # Email configuration
  EMAIL_HOST: "smtp.gmail.com"
  EMAIL_PORT: "587"
  EMAIL_USE_TLS: "True"
  EMAIL_HOST_USER: "your-email@gmail.com"
  EMAIL_HOST_PASSWORD: "your-app-password"
  DEFAULT_FROM_EMAIL: "your-email@gmail.com"
  
  # OAuth configuration
  GOOGLE_OAUTH2_CLIENT_ID: "your-google-oauth-client-id"
  GOOGLE_OAUTH2_CLIENT_SECRET: "your-google-oauth-client-secret"
  
  # JWT configuration
  JWT_SECRET_KEY: "your-super-secret-jwt-key"
  SECRET_KEY: "your-super-secret-django-key"

beta_settings:
  cloud_sql_instances: "your-project-id:your-region:your-instance-name"

handlers:
# This configures Google App Engine to serve the files in the app's static
# directory.
- url: /static
  static_dir: staticfiles

# This handler routes all requests not caught above to your main app. It is
# required when static routes are defined, but can be omitted (along with
# the entire handlers section) when there are no static files defined.
- url: /.*
  script: auto